<% layout('layouts/boilerplate') -%>
<h1>Edit Recipe!</h1>

<%
    findWithAttr = function (array, attr, value) {
        for(var i = 0; i < array.length; i += 1) {
            if(array[i][attr] === value) {
                return i;
            }
        }
        return -1;
    }
 %>
<form action="/recipes/<%= recipe.id %>?_method=PUT" method="POST">
    <input type="text" name="title" placeholder="Title" value="<%= recipe.title %>">
    <select name="ingredients" id="ingredients" multiple>
        <% ingredients.forEach(ingredient => { %>
            <% if ( findWithAttr(recipe.ingredients, '_id', ingredient.id)  !== -1) { %>
                <option value="<%= ingredient.id %>" selected><%= ingredient.title %></option>
            <% } else { %>
                    <option value="<%= ingredient.id %>"><%= ingredient.title %></option>
            <% } %>
        <% }); %>
    </select>
    <textarea name="preparation" id="" cols="30" rows="10"></textarea>
    <input type="submit" value="Update">
</form>
